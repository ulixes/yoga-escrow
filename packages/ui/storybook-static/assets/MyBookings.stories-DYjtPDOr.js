import{j as a}from"./jsx-runtime-CDt2p4po.js";import{r as f,R as b}from"./index-GiUgBvb1.js";function O(e){const n=e>=0?"+":"-",s=Math.abs(e),t=Math.floor(s/60).toString().padStart(2,"0"),r=(s%60).toString().padStart(2,"0");return`UTC${n}${t}:${r}`}function I(e){const n=typeof e.startTime=="bigint"?Number(e.startTime):e.startTime,s=new Date(n*1e3),t=s.toLocaleDateString(void 0,{month:"short",day:"numeric",weekday:"short"}),r=s.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"}),d=O(e.timezoneOffset);return`${t} · ${r} (${d})`}function S(e){return[e.city,e.specificLocation].filter(Boolean).join(" · ")}function Y(e){if(e<=0)return"Expired";const n=Math.floor(e/1e3),s=Math.floor(n/86400),t=Math.floor(n%86400/3600),r=Math.floor(n%3600/60);return s>0?`${s}d ${t}h`:t>0?`${t}h ${r}m`:`${r}m`}function U({status:e}){return a.jsx("span",{className:`yui-badge yui-badge--${e.toLowerCase()}`,children:e})}function F({escrow:e,onAssign:n,onCancel:s,onRelease:t,onDispute:r,onAutoRelease:d,onViewDetails:c,skin:m="ulyxes",showActions:A=!0,fiatCurrency:y="USD",ethToFiatRate:g,formatFiat:v}){const C=f.useMemo(()=>{var p;if(e.status==="Assigned"&&e.selected.yogaIndex!==void 0){const x=e.selected.yogaIndex;return e.yogaTypes[x]}return((p=e.description)==null?void 0:p.trim())||"Yoga class"},[e]),i=e.status==="Cancelled",N=f.useMemo(()=>{if(e.status==="Assigned"||e.status==="Completed"||e.status==="Disputed"){const p=e.selected.handle||e.teacherHandles[e.selected.payeeIndex??0];return p?`Teacher: ${p}`:void 0}return`Pick from: ${e.teacherHandles.join(", ")}`},[e]),W=f.useMemo(()=>e.selected.timeIndex!==void 0?I(e.timeSlots[e.selected.timeIndex]):e.timeSlots.map(I).join(" • "),[e]),w=f.useMemo(()=>e.selected.locationIndex!==void 0?S(e.locations[e.selected.locationIndex]):e.locations.map(S).join(" • "),[e]),B=f.useMemo(()=>e.isExpired?"Expired":`Expires in ${Y(e.timeToExpireMs)}`,[e]),z=m;return a.jsxs("div",{className:`yui-class-item ${i?"yui-class-item--cancelled":""}`,"data-skin":z,children:[a.jsxs("div",{className:"yui-class-item__left",children:[a.jsx("div",{className:"yui-class-item__status",children:a.jsx(U,{status:e.status})}),a.jsxs("div",{className:"yui-class-item__meta",children:[a.jsx("div",{className:`yui-class-item__title ${i?"yui-class-item__title--cancelled":""}`,children:C}),a.jsxs("div",{className:"yui-class-item__sub",children:[a.jsxs("span",{className:"yui-class-item__amount",children:[e.amountEth," ETH"]}),typeof g=="number"&&!Number.isNaN(g)?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"yui-dot-sep"}),a.jsx("span",{className:"yui-class-item__fiat",children:(()=>{const x=Number.parseFloat(e.amountEth)*g;if(v)return v(x,y);try{return new Intl.NumberFormat(void 0,{style:"currency",currency:y}).format(x)}catch{return`${y} ${x.toFixed(2)}`}})()})]}):null,N&&a.jsx("span",{className:"yui-dot-sep"}),N&&a.jsx("span",{children:N})]}),a.jsx("div",{className:"yui-class-item__details",children:a.jsx("span",{className:`yui-class-item__time ${i?"yui-class-item__time--cancelled":""}`,children:W})}),a.jsx("div",{className:"yui-class-item__details",children:a.jsx("span",{className:"yui-class-item__location",children:w})}),(e.status==="Assigned"||e.status==="Created")&&a.jsx("div",{className:`yui-class-item__expires ${e.isExpired?"is-expired":""}`,children:B}),i&&a.jsxs("div",{className:"yui-class-item__cancelled-info",children:[a.jsx("div",{className:"yui-class-item__cancelled-status",children:a.jsx("span",{className:"yui-class-item__cancelled-label",children:"Cancelled by Student"})}),a.jsxs("div",{className:"yui-class-item__cancelled-outcome",children:["Full refund of ",e.amountEth," ETH was returned to the student."]})]})]})]}),A&&a.jsxs("div",{className:"yui-class-item__actions",children:[e.status==="Created"&&a.jsxs(a.Fragment,{children:[n&&a.jsx("button",{className:"yui-btn yui-btn--primary",onClick:()=>n(e.id),children:"Assign teacher"}),a.jsx("button",{className:"yui-btn yui-btn--ghost",onClick:()=>s==null?void 0:s(e.id),children:"Cancel"})]}),e.status==="Assigned"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"yui-btn yui-btn--primary",onClick:()=>t==null?void 0:t(e.id),children:"Release"}),a.jsx("button",{className:"yui-btn yui-btn--ghost",onClick:()=>r==null?void 0:r(e.id),children:"Dispute"}),e.canTriggerAutoRelease&&a.jsx("button",{className:"yui-btn yui-btn--link",onClick:()=>d==null?void 0:d(e.id),children:"Auto-release"})]}),(e.status==="Completed"||e.status==="Cancelled"||e.status==="Disputed")&&a.jsx("button",{className:"yui-btn yui-btn--link",onClick:()=>c==null?void 0:c(e.id),children:"View details"})]})]})}F.__docgenInfo={description:"",methods:[],displayName:"ClassItem",props:{escrow:{required:!0,tsType:{name:"StudentEscrow"},description:""},onAssign:{required:!1,tsType:{name:"signature",type:"function",raw:"(escrowId: bigint) => void",signature:{arguments:[{type:{name:"unknown"},name:"escrowId"}],return:{name:"void"}}},description:""},onCancel:{required:!1,tsType:{name:"signature",type:"function",raw:"(escrowId: bigint) => void",signature:{arguments:[{type:{name:"unknown"},name:"escrowId"}],return:{name:"void"}}},description:""},onRelease:{required:!1,tsType:{name:"signature",type:"function",raw:"(escrowId: bigint) => void",signature:{arguments:[{type:{name:"unknown"},name:"escrowId"}],return:{name:"void"}}},description:""},onDispute:{required:!1,tsType:{name:"signature",type:"function",raw:"(escrowId: bigint) => void",signature:{arguments:[{type:{name:"unknown"},name:"escrowId"}],return:{name:"void"}}},description:""},onAutoRelease:{required:!1,tsType:{name:"signature",type:"function",raw:"(escrowId: bigint) => void",signature:{arguments:[{type:{name:"unknown"},name:"escrowId"}],return:{name:"void"}}},description:""},onViewDetails:{required:!1,tsType:{name:"signature",type:"function",raw:"(escrowId: bigint) => void",signature:{arguments:[{type:{name:"unknown"},name:"escrowId"}],return:{name:"void"}}},description:""},skin:{required:!1,tsType:{name:"union",raw:"'ulyxes' | 'default'",elements:[{name:"literal",value:"'ulyxes'"},{name:"literal",value:"'default'"}]},description:"",defaultValue:{value:"'ulyxes'",computed:!1}},showActions:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},fiatCurrency:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"'USD'",computed:!1}},ethToFiatRate:{required:!1,tsType:{name:"number"},description:""},formatFiat:{required:!1,tsType:{name:"signature",type:"function",raw:"(fiatAmount: number, currency: string) => string",signature:{arguments:[{type:{name:"number"},name:"fiatAmount"},{type:{name:"string"},name:"currency"}],return:{name:"string"}}},description:""}}};function P({items:e,emptyState:n,skin:s="ulyxes",showActions:t=!0,...r}){return!e||e.length===0?a.jsx("div",{className:"yui-class-list","data-skin":s,children:n??a.jsx("div",{className:"yui-empty",children:"No bookings yet"})}):a.jsx("div",{className:"yui-class-list","data-skin":s,children:e.map(d=>a.jsx("div",{className:"yui-class-list__item",children:a.jsx(F,{escrow:d,skin:s,showActions:t,...r})},d.id.toString()))})}P.__docgenInfo={description:"",methods:[],displayName:"ClassList",props:{items:{required:!0,tsType:{name:"Array",elements:[{name:"StudentEscrow"}],raw:"StudentEscrow[]"},description:""},emptyState:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},skin:{defaultValue:{value:"'ulyxes'",computed:!1},required:!1},showActions:{defaultValue:{value:"true",computed:!1},required:!1}},composes:["Pick"]};function G(e,n){if(n==="all")return e;if(n==="active")return e.filter(t=>t.status==="Created"||t.status==="Assigned");if(n==="history")return e.filter(t=>t.status==="Completed"||t.status==="Cancelled").sort((t,r)=>{const d=c=>{if(c.selected.timeIndex!==void 0){const m=c.timeSlots[c.selected.timeIndex];return typeof m.startTime=="bigint"?Number(m.startTime):m.startTime}return c.createdAt};return d(r)-d(t)});const s={created:"Created",assigned:"Assigned",completed:"Completed",cancelled:"Cancelled",disputed:"Disputed"};return e.filter(t=>t.status===s[n])}const h=({items:e,initialFilter:n="active",skin:s="ulyxes",className:t,emptyState:r,...d})=>{const[c,m]=b.useState(n),A=b.useMemo(()=>G(e??[],c),[e,c]),y=b.useMemo(()=>(e==null?void 0:e.filter(i=>i.status==="Created"||i.status==="Assigned").length)??0,[e]),g=b.useMemo(()=>(e==null?void 0:e.filter(i=>i.status==="Completed"||i.status==="Cancelled").length)??0,[e]),v=["yui-bookings",t].filter(Boolean).join(" "),C=[{key:"active",label:"Active",count:y},{key:"history",label:"Class History",count:g},{key:"created",label:"Created"},{key:"assigned",label:"Assigned"},{key:"completed",label:"Completed"},{key:"disputed",label:"Disputed"},{key:"cancelled",label:"Cancelled"},{key:"all",label:"All"}];return a.jsxs("section",{className:v,"data-skin":s,"aria-label":"My bookings",children:[a.jsxs("header",{className:"yui-bookings__header",children:[a.jsx("div",{className:"yui-bookings__title",children:"Your bookings"}),a.jsx("div",{className:"yui-bookings__filters",role:"tablist","aria-label":"Filter bookings",children:C.map(i=>a.jsxs("button",{role:"tab","aria-selected":c===i.key,className:"yui-tab","data-active":c===i.key,onClick:()=>m(i.key),children:[i.label,typeof i.count=="number"?` (${i.count})`:""]},i.key))})]}),a.jsx(P,{items:A,skin:s,emptyState:r??a.jsx("div",{className:"yui-empty",children:"No bookings"}),...d})]})};h.__docgenInfo={description:"",methods:[],displayName:"MyBookings",props:{items:{required:!0,tsType:{name:"Array",elements:[{name:"StudentEscrow"}],raw:"StudentEscrow[]"},description:""},initialFilter:{required:!1,tsType:{name:"union",raw:"'all' | 'active' | 'created' | 'assigned' | 'completed' | 'cancelled' | 'disputed' | 'history'",elements:[{name:"literal",value:"'all'"},{name:"literal",value:"'active'"},{name:"literal",value:"'created'"},{name:"literal",value:"'assigned'"},{name:"literal",value:"'completed'"},{name:"literal",value:"'cancelled'"},{name:"literal",value:"'disputed'"},{name:"literal",value:"'history'"}]},description:"",defaultValue:{value:"'active'",computed:!1}},skin:{required:!1,tsType:{name:"union",raw:"'ulyxes' | 'default'",elements:[{name:"literal",value:"'ulyxes'"},{name:"literal",value:"'default'"}]},description:"",defaultValue:{value:"'ulyxes'",computed:!1}},className:{required:!1,tsType:{name:"string"},description:""},emptyState:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}},composes:["Pick"]};const Q={title:"Ulyx/MyBookings",component:h},u=Math.floor(Date.now()/1e3),l=e=>({startTime:u+e*3600,durationMinutes:60,timezoneOffset:0}),o=e=>({country:"Georgia",city:"Tbilisi",specificLocation:e}),_=[{id:1n,payer:"0xabc0000000000000000000000000000000000000",amountWei:0n,status:"Created",createdAt:u-3600,expiresAt:u+72*3600,description:"Morning flow",teacherHandles:["@lena","@zoe","@amir"],yogaTypes:["Vinyasa","Yin","Hatha"],timeSlots:[l(24),l(30),l(48)],locations:[o("Vake Park"),o("Lisi Lake"),o("Turtle Lake")],selected:{},amountEth:"0.05",isExpired:!1,timeToExpireMs:1e3*60*60*72,canAssign:!0,canCancel:!0,canRelease:!1,canDispute:!1,canTriggerAutoRelease:!1},{id:2n,payer:"0xabc0000000000000000000000000000000000000",amountWei:0n,status:"Assigned",createdAt:u-7200,expiresAt:u+24*3600,description:"Deep stretch",teacherHandles:["@maya","@zoe","@amir"],yogaTypes:["Yin","Vinyasa","Hatha"],timeSlots:[l(18),l(26),l(40)],locations:[o("Vake Park"),o("Lisi Lake"),o("Turtle Lake")],selected:{payeeIndex:0,yogaIndex:0,timeIndex:0,locationIndex:1,handle:"@maya"},amountEth:"0.08",isExpired:!1,timeToExpireMs:1e3*60*60*24,canAssign:!1,canCancel:!1,canRelease:!0,canDispute:!0,canTriggerAutoRelease:!0},{id:3n,payer:"0xabc0000000000000000000000000000000000000",amountWei:0n,status:"Disputed",createdAt:u-7200,expiresAt:u-3600,description:"Evening power",teacherHandles:["@alex","@zoe","@amir"],yogaTypes:["Power","Vinyasa","Hatha"],timeSlots:[l(-48),l(-24),l(-18)],locations:[o("Gym Central"),o("Lisi Lake"),o("Turtle Lake")],selected:{payeeIndex:0,yogaIndex:0,timeIndex:2,locationIndex:0,handle:"@alex"},amountEth:"0.1",isExpired:!0,timeToExpireMs:-1e3*60*60,canAssign:!1,canCancel:!1,canRelease:!1,canDispute:!1,canTriggerAutoRelease:!1},{id:4n,payer:"0xabc0000000000000000000000000000000000000",amountWei:0n,status:"Cancelled",createdAt:u-86400,expiresAt:u-3600,description:"Beginner Hatha Yoga",teacherHandles:["@lena","@maya","@alex"],yogaTypes:["Hatha","Yin","Vinyasa"],timeSlots:[l(-12),l(-6),l(2)],locations:[o("Vake Park"),o("Rustaveli Studio"),o("Old Town")],selected:{payeeIndex:0,yogaIndex:0,timeIndex:0,locationIndex:0,handle:"@lena"},amountEth:"0.0025",isExpired:!0,timeToExpireMs:-1e3*60*60,canAssign:!1,canCancel:!1,canRelease:!1,canDispute:!1,canTriggerAutoRelease:!1},{id:5n,payer:"0xabc0000000000000000000000000000000000000",amountWei:0n,status:"Completed",createdAt:u-172800,expiresAt:u-86400,description:"Power Yoga Session",teacherHandles:["@maya","@alex","@zoe"],yogaTypes:["Power","Ashtanga","Vinyasa"],timeSlots:[l(-36),l(-30),l(-24)],locations:[o("Saburtalo Center"),o("Lisi Lake"),o("Gym Central")],selected:{payeeIndex:1,yogaIndex:0,timeIndex:2,locationIndex:0,handle:"@alex"},amountEth:"0.004",isExpired:!0,timeToExpireMs:-1e3*60*60*24,canAssign:!1,canCancel:!1,canRelease:!1,canDispute:!1,canTriggerAutoRelease:!1},{id:6n,payer:"0xabc0000000000000000000000000000000000000",amountWei:0n,status:"Cancelled",createdAt:u-259200,expiresAt:u-172800,description:"Vinyasa Flow",teacherHandles:["@zoe","@lena","@maya"],yogaTypes:["Vinyasa","Yin","Hatha"],timeSlots:[l(-60),l(-54),l(-48)],locations:[o("Turtle Lake"),o("Vake Park"),o("Old Town")],selected:{payeeIndex:0,yogaIndex:0,timeIndex:1,locationIndex:2,handle:"@zoe"},amountEth:"0.003",isExpired:!0,timeToExpireMs:-1e3*60*60*48,canAssign:!1,canCancel:!1,canRelease:!1,canDispute:!1,canTriggerAutoRelease:!1}],k={render:()=>a.jsx("div",{"data-skin":"ulyxes",style:{maxWidth:760},children:a.jsx(h,{items:_,onAssign:e=>console.log("assign",e),onCancel:e=>console.log("cancel",e),onRelease:e=>console.log("release",e),onDispute:e=>console.log("dispute",e),onAutoRelease:e=>console.log("autoRelease",e),onViewDetails:e=>console.log("details",e)})})},T={render:()=>a.jsx("div",{"data-skin":"ulyxes",style:{maxWidth:760},children:a.jsx(h,{items:_,initialFilter:"history",onAssign:e=>console.log("assign",e),onCancel:e=>console.log("cancel",e),onRelease:e=>console.log("release",e),onDispute:e=>console.log("dispute",e),onAutoRelease:e=>console.log("autoRelease",e),onViewDetails:e=>console.log("details",e)})})},j={render:()=>a.jsx("div",{"data-skin":"ulyxes",style:{maxWidth:760},children:a.jsx(h,{items:_,initialFilter:"cancelled",onAssign:e=>console.log("assign",e),onCancel:e=>console.log("cancel",e),onRelease:e=>console.log("release",e),onDispute:e=>console.log("dispute",e),onAutoRelease:e=>console.log("autoRelease",e),onViewDetails:e=>console.log("details",e)})})};var E,R,M;k.parameters={...k.parameters,docs:{...(E=k.parameters)==null?void 0:E.docs,source:{originalSource:`{
  render: () => <div data-skin="ulyxes" style={{
    maxWidth: 760
  }}>
      <MyBookings items={demo} onAssign={id => console.log('assign', id)} onCancel={id => console.log('cancel', id)} onRelease={id => console.log('release', id)} onDispute={id => console.log('dispute', id)} onAutoRelease={id => console.log('autoRelease', id)} onViewDetails={id => console.log('details', id)} />
    </div>
}`,...(M=(R=k.parameters)==null?void 0:R.docs)==null?void 0:M.source}}};var D,L,V;T.parameters={...T.parameters,docs:{...(D=T.parameters)==null?void 0:D.docs,source:{originalSource:`{
  render: () => <div data-skin="ulyxes" style={{
    maxWidth: 760
  }}>
      <MyBookings items={demo} initialFilter="history" onAssign={id => console.log('assign', id)} onCancel={id => console.log('cancel', id)} onRelease={id => console.log('release', id)} onDispute={id => console.log('dispute', id)} onAutoRelease={id => console.log('autoRelease', id)} onViewDetails={id => console.log('details', id)} />
    </div>
}`,...(V=(L=T.parameters)==null?void 0:L.docs)==null?void 0:V.source}}};var $,q,H;j.parameters={...j.parameters,docs:{...($=j.parameters)==null?void 0:$.docs,source:{originalSource:`{
  render: () => <div data-skin="ulyxes" style={{
    maxWidth: 760
  }}>
      <MyBookings items={demo} initialFilter="cancelled" onAssign={id => console.log('assign', id)} onCancel={id => console.log('cancel', id)} onRelease={id => console.log('release', id)} onDispute={id => console.log('dispute', id)} onAutoRelease={id => console.log('autoRelease', id)} onViewDetails={id => console.log('details', id)} />
    </div>
}`,...(H=(q=j.parameters)==null?void 0:q.docs)==null?void 0:H.source}}};const X=["Default","ClassHistory","CancelledOnly"];export{j as CancelledOnly,T as ClassHistory,k as Default,X as __namedExportsOrder,Q as default};
